library(dplyr)
el <- read.csv("47130-8314.csv", encoding = "UTF-8")
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
colnames(el) <- c("region", "tik", "uik", "total", "invalid", "valid",
"Zh", "Zug", "Mir", "Pro", "Put")
el <- el %>% mutate(turnout = invalid + valid)
aggr_reg  <- el %>% group_by(region) %>%
summarise(total = sum(total),
turnout = sum(turnout),
Zh = sum(Zh),
Zug = sum(Zug),
Mir = sum(Mir),
Pro = sum(Pro),
Put = sum(Put))
aggr_reg <- aggr_reg %>%
mutate(turnout_perc = turnout / total * 100,
Zh_perc = Zh / turnout * 100,
Zug_perc = Zug / turnout * 100,
Mir_perc = Mir / turnout * 100,
Pro_perc = Pro / turnout * 100,
Put_perc = Put / turnout * 100)
aggr_reg <- aggr_reg %>% filter(!is.na(total))
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
el <- read.csv("47130-8314.csv", encoding = "UTF-8")
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
colnames(el) <- c("region", "tik", "uik", "total", "invalid", "valid",
"Zh", "Zug", "Mir", "Pro", "Put")
el <- el %>% mutate(turnout = invalid + valid)
el <- el %>% mutate(turnout_perc = turnout / total * 100)
el <- na.omit(el)
View(el)
View(el)
el$region
"Республика" %in% el$region
View(el)
"Республика" %in% el$region[1]
"Республика" %in% el$region[100]
?ifelse
el2 <- el %>% mutate(reg_type = ifelse("Республика" %in% reg_type, "республика", ""))
el2 <- el %>% mutate(reg_type = ifelse("Республика" %in% region, "республика", ""))
View(el2)
el2 <- el %>% mutate(reg_type = ifelse(grepl(region "Республика"), "республика", ""))
el2 <- el %>% mutate(reg_type = ifelse(any("Республика" %in% region ), "республика", ""))
View(el2)
el2 <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)))
View(el2)
el2 <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)))
el2 <- el %>% mutate(oblast = as.integer(grepl(pattern = "область", region)))
el2 <- el %>% mutate(a_oblast = as.integer(grepl(pattern = "автономная область", region)))
el2 <- el %>% mutate(krai = as.integer(grepl(pattern = "край", region)))
View(el2)
el2 <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)))
View(el2)
el2 <- el %>% mutate(oblast = as.integer(grepl(pattern = "область", region)))
el2 <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
krai = as.integer(grepl(pattern = "край", region)))
View(el2)
el4region
el$region
?gather
library(tidyr)
?gather
el2 %>% gather(resp, oblast, a_oblast, krai)
?max.col
?names
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
krai = as.integer(grepl(pattern = "край", region)))
View(el)
el$reg_type <- names(el[resp:krai])[max.col(el[resp:krai])]))
el$reg_type <- names(el[resp:krai])[max.col(el[resp:krai])])
el %>% names(resp:krai)
el %>% names(select(resp:krai))
el[14:17]
View(el[14:17])
el$reg_type <- names(el[14:17])[max.col(el[14:17])]
el <- read.csv("47130-8314.csv", encoding = "UTF-8")
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
colnames(el) <- c("region", "tik", "uik", "total", "invalid", "valid",
"Zh", "Zug", "Mir", "Pro", "Put")
el <- el %>% mutate(turnout = invalid + valid)
el <- el %>% mutate(turnout_perc = turnout / total * 100)
el <- filter(region != "Территория за пределами РФ")
el <- el %>% filter(region != "Территория за пределами РФ")
el <- na.omit(el)
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
krai = as.integer(grepl(pattern = "край", region)))
el$reg_type <- names(el[14:17])[max.col(el[14:17])]
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
okrug = as.integer(grepl(pattern = "округ", region)),
krai = as.integer(grepl(pattern = "край", region)))
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
okrug = as.integer(grepl(pattern = "округ", region)),
krai = as.integer(grepl(pattern = "край", region)),
gorod = as.integer(grepl(pattern = "Город", region)))
View(el[14:19])
el <- read.csv("47130-8314.csv", encoding = "UTF-8")
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
colnames(el) <- c("region", "tik", "uik", "total", "invalid", "valid",
"Zh", "Zug", "Mir", "Pro", "Put")
el <- el %>% mutate(turnout = invalid + valid)
el <- el %>% mutate(turnout_perc = turnout / total * 100)
el <- el %>% filter(region != "Территория за пределами РФ")
el <- na.omit(el)
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
okrug = as.integer(grepl(pattern = "округ", region)),
krai = as.integer(grepl(pattern = "край", region)),
gorod = as.integer(grepl(pattern = "Город", region)))
View(el[14:])
View(el[14:19])
View(el[14:20])
el$reg_type <- names(el[14:19])[max.col(el[14:19])]
el <- read.csv("47130-8314.csv", encoding = "UTF-8")
el <- el %>% select(kom1, kom2, kom3, X1, X9, X10, X19, X20, X21, X22, X23)
colnames(el) <- c("region", "tik", "uik", "total", "invalid", "valid",
"Zh", "Zug", "Mir", "Pro", "Put")
el <- el %>% mutate(turnout = invalid + valid)
el <- el %>% mutate(turnout_perc = turnout / total * 100)
el <- el %>% filter(region != "Территория за пределами РФ", region != "Город Байконур (Республика Казахстан)")
el <- na.omit(el)
el <- el %>% mutate(resp = as.integer(grepl(pattern = "Республика", region)),
oblast = as.integer(grepl(pattern = "область", region)),
a_oblast = as.integer(grepl(pattern = "автономная область", region)),
okrug = as.integer(grepl(pattern = "округ", region)),
krai = as.integer(grepl(pattern = "край", region)),
gorod = as.integer(grepl(pattern = "Город", region)))
el$reg_type <- names(el[14:19])[max.col(el[14:19])]
unique(reg_type)
unique(el$reg_type)
barplot(table(unique(el$reg_type))
barplot(table(unique(el$reg_type)))
barplot(table(unique(el$reg_type)))
el %>% group_by(region) %>% barplot(table(reg_type))
table(el$reg_type)
barplot(table(el$reg_type))
barplot(table(el$reg_type), freq = T)
?barplot
barplot(prop.table(el$reg_type), freq = T)
barplot(prop.table(el$reg_type))
barplot(table(el$reg_type))
